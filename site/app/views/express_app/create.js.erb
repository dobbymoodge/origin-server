<%
  ajax_response = {:data => {}, :event => 'app_form_return'}
  if @message_type == :success
    ajax_response[:status] = 'success'
    ajax_response[:data][:app_table] = render 'app_table', :apps => @userinfo.app_info
    ajax_response[:data][:app_limit_reached] = @userinfo.app_info.length >= @max_apps 
  else
    ajax_response[:status] = 'error'
    ajax_response[:data] = @message
  end
%>
<%=raw ajax_response.to_json() %>

