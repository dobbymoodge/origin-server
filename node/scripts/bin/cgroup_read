#!/usr/bin/ruby

# Author: Mike McGrath - mmcgrath@redhat.com
# When combined with selinux, this script will allow users to read their own
# cgroups entries but not other users cgroups entries

require 'etc'

login = Etc.getlogin

attribute=ARGV[0]

unless attribute =~ /\A[a-zA-Z0-9\.\-_]*\z/
    puts "#{attribute} is an invalid attribute"
    exit 1
end

if File.exists? "/cgroup/all/libra/#{login}/#{attribute}"
    fp = File.new("/cgroup/all/libra/#{login}/#{attribute}")
    value = fp.gets
    fp.close
else
    puts "Could not find attribute #{attribute}"
    exit 2
end

puts value
