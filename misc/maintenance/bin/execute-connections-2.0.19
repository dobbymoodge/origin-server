#!/usr/bin/env ruby
require '/var/www/openshift/broker/config/environment'

CloudUser.find_all(nil).each { |u|
  u.applications.each { |a|
    if a.scalable
       puts a.name
       a.elaborate_descriptor
       carts = a.embedded.keys.dup
       carts << a.framework
       carts.each { |comp|
         a.expose_port(comp)
       }
       a.execute_connections
    end
  }
}